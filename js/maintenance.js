let StoreData = [
    {
        code: '4521',
        imel: '541236789547801',
        sn: 'PB10214C55305',
        typeOfdevice: 'sunmi',
        typeOfpay: 'free',
        stateOfdevice: 'ذهاب',
        paydate: '14/8/2024',
        payvalue: 500,
        traderCode: '1122',
        traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
    },
    {
        code: '4521',
		imel: '541236789547801',
		sn: 'PB10214C55305',
		typeOfdevice: 'sunmi',
		typeOfpay: 'تقسيط',
		stateOfdevice: 'عودة',
		paydate: '14/8/2024',
		payvalue: 500,
		traderCode: '1122',
		traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
	},
    {
        code: '4521',
		imel: '541236789547801',
		sn: 'PB10214C55305',
		typeOfdevice: 'sunmi',
		typeOfpay: 'cash',
		stateOfdevice: 'رفض صيانة',
		paydate: '14/8/2024',
		payvalue: 500,
		traderCode: '1122',
		traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
	},
    
    {
        code: '4521',
        imel: '541236789547801',
        sn: 'PB10214C55305',
        typeOfdevice: 'ingenico',
        typeOfpay: 'free',
        stateOfdevice: 'ذهاب',
        paydate: '14/8/2024',
        payvalue: 500,
        traderCode: '1122',
        traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
    },
    {
        code: '4521',
		imel: '541236789547801',
		sn: 'PB10214C55305',
		typeOfdevice: 'ingenico',
		typeOfpay: 'تقسيط',
		stateOfdevice: 'عودة',
		paydate: '14/8/2024',
		payvalue: 500,
		traderCode: '1122',
		traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
	},
    {
        code: '4521',
		imel: '541236789547801',
		sn: 'PB10214C55305',
		typeOfdevice: 'ingenico',
		typeOfpay: 'cash',
		stateOfdevice: 'رفض صيانة',
		paydate: '14/8/2024',
		payvalue: 500,
		traderCode: '1122',
		traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
	},
    
    {
        code: '4521',
        imel: '541236789547801',
        sn: 'PB10214C55305',
        typeOfdevice: 'pax',
        typeOfpay: 'free',
        stateOfdevice: 'ذهاب',
        paydate: '14/8/2024',
        payvalue: 500,
        traderCode: '1122',
        traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
    },
    {
        code: '4521',
		imel: '541236789547801',
		sn: 'PB10214C55305',
		typeOfdevice: 'pax',
		typeOfpay: 'تقسيط',
		stateOfdevice: 'عودة',
		paydate: '14/8/2024',
		payvalue: 500,
		traderCode: '1122',
		traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
	},
    {
        code: '4521',
		imel: '541236789547801',
		sn: 'PB10214C55305',
		typeOfdevice: 'pax',
		typeOfpay: 'cash',
		stateOfdevice: 'رفض صيانة',
		paydate: '14/8/2024',
		payvalue: 500,
		traderCode: '1122',
		traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
	},
    
    {
        code: '4521',
        imel: '541236789547801',
        sn: 'PB10214C55305',
        typeOfdevice: 'mobiwire',
        typeOfpay: 'free',
        stateOfdevice: 'ذهاب',
        paydate: '14/8/2024',
        payvalue: 500,
        traderCode: '1122',
        traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
    },
    {
        code: '4521',
		imel: '541236789547801',
		sn: 'PB10214C55305',
		typeOfdevice: 'mobiwire',
		typeOfpay: 'تقسيط',
		stateOfdevice: 'عودة',
		paydate: '14/8/2024',
		payvalue: 500,
		traderCode: '1122',
		traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
	},
    {
        code: '4521',
		imel: '541236789547801',
		sn: 'PB10214C55305',
		typeOfdevice: 'mobiwire',
		typeOfpay: 'cash',
		stateOfdevice: 'رفض صيانة',
		paydate: '14/8/2024',
		payvalue: 500,
		traderCode: '1122',
		traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
	},
    
    {
        code: '4521',
        imel: '541236789547801',
        sn: 'PB10214C55305',
        typeOfdevice: 'verifone',
        typeOfpay: 'free',
        stateOfdevice: 'ذهاب',
        paydate: '14/8/2024',
        payvalue: 500,
        traderCode: '1122',
        traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
    },
    {
        code: '4521',
		imel: '541236789547801',
		sn: 'PB10214C55305',
		typeOfdevice: 'verifone',
		typeOfpay: 'تقسيط',
		stateOfdevice: 'عودة',
		paydate: '14/8/2024',
		payvalue: 500,
		traderCode: '1122',
		traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
	},
    {
        code: '4521',
		imel: '541236789547801',
		sn: 'PB10214C55305',
		typeOfdevice: 'verifone',
		typeOfpay: 'cash',
		stateOfdevice: 'رفض صيانة',
		paydate: '14/8/2024',
		payvalue: 500,
		traderCode: '1122',
		traderName: 'خدمات محمول ابوليله',
        exitdate: "22/7/2025",
        backdate: "27/9/2025",
        maintenanceCoast: 1350, 
	},
    
];
document.getElementById('User_Name_Show').innerHTML = localStorage.getItem('name');
function ReadData() {
	let data = ``;
	for (let i = 0; i < StoreData.length; i++) {
		data += `
            <tr>
                <td>${StoreData[i].code}</td>
                <td>${StoreData[i].imel}</td>
                <td>${StoreData[i].sn}</td>
                <td>${StoreData[i].typeOfdevice}</td>
                <td>${StoreData[i].typeOfpay}</td>
                <td>${StoreData[i].stateOfdevice}</td>
                <td>${StoreData[i].paydate}</td>
                <td>${StoreData[i].payvalue}</td>
                <td>${StoreData[i].traderCode}</td>
                <td>${StoreData[i].traderName}</td>
                <td>${StoreData[i].exitdate}</td>
                <td>${StoreData[i].backdate}</td>
                <td>${StoreData[i].maintenanceCoast}</td>
                <td>
                    <div class="dropdown">
                        <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" style="padding: 0 !important; height: 35px; width: 55px;">
                            <svg class="svg-inline--fa fa-gear p-1" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="gear" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"></path></svg><!-- <i class="fa fa-cog p-1"></i> Font Awesome fontawesome.com -->
                        </button>
                        <div class="dropdown-menu" style="position: absolute; transform: translate3d(2px, 35px, 0px); top: 0px; left: 0px; will-change: transform;" x-placement="bottom-start">
                            <button class="btn btn-primary my-2" onclick="updateData(${i})" data-toggle="modal" data-target="#editdata">تعديل</button>
                            <button class="btn btn-danger my-2" onclick="deleteData(${i})" id="delete">الحذف</button>
                        </div>
                    </div>
                </td>
            </tr>
        `;
	}
	document.querySelector('#body-data').innerHTML = data;
    devices();
}
ReadData();

let code = document.querySelector('#code');
let imel = document.querySelector('#imel');
let sn = document.querySelector('#sn');
let typeOfdevice = document.querySelector('#typeOfdevice');
let typeOfpay = document.querySelector('#typeOfpay');
let stateOfdevice = document.querySelector('#stateOfdevice');
let paydate = document.querySelector('#paydate');
let payvalue = document.querySelector('#payvalue');
let traderCode = document.querySelector('#traderCode');
let traderName = document.querySelector('#traderName');
let exitdate = document.querySelector('#exitdate');
let backdate = document.querySelector('#backdate');
let maintenanceCoast = document.querySelector('#maintenanceCoast');
let tmp;
let mood = 'create';
let searchMood = 'code';

function getsearchMood(value){
    if(value == 'code'){
        searchMood = 'code';
        searchInput.placeholder = 'البحث بالمعرف';
    }else if(value == 'type'){
        searchMood = 'type';
        searchInput.placeholder = 'البحث بنوع الجهاز';
    }else if(value == 'typeOFpay'){
        searchMood = 'typeOFpay';
        searchInput.placeholder = 'البحث بنوع الدفع';
    }else if(value == 'stateOFdevice'){
        searchMood = 'stateOFdevice';
        searchInput.placeholder = 'البحث بالحالة';
    }else if(value == 'imei'){
        searchMood = 'imei';
        searchInput.placeholder = 'ادخل IMEI';
    }else{
        searchMood = 'sn';
        searchInput.placeholder = 'ادخل SN';
    }
}
function searchOperation(value){
    let data = ``;
    if(searchMood === 'code'){
        for(i=0; i < StoreData.length; i++){
            if(StoreData[i].code.includes(value)){
                data += `
                    <tr>
                        <td>${StoreData[i].code}</td>
                        <td>${StoreData[i].imel}</td>
                        <td>${StoreData[i].sn}</td>
                        <td>${StoreData[i].typeOfdevice}</td>
                        <td>${StoreData[i].typeOfpay}</td>
                        <td>${StoreData[i].stateOfdevice}</td>
                        <td>${StoreData[i].paydate}</td>
                        <td>${StoreData[i].payvalue}</td>
                        <td>${StoreData[i].traderCode}</td>
                        <td>${StoreData[i].traderName}</td>
                        <td>${StoreData[i].exitdate}</td>
                        <td>${StoreData[i].backdate}</td>
                        <td>${StoreData[i].maintenanceCoast}</td>
                        <td>
                            <div class="dropdown">
                                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" style="padding: 0 !important; height: 35px; width: 55px;">
                                    <svg class="svg-inline--fa fa-gear p-1" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="gear" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"></path></svg><!-- <i class="fa fa-cog p-1"></i> Font Awesome fontawesome.com -->
                                </button>
                                <div class="dropdown-menu" style="position: absolute; transform: translate3d(2px, 35px, 0px); top: 0px; left: 0px; will-change: transform;" x-placement="bottom-start">
                                    <button class="btn btn-primary my-2" onclick="updateData(${i})" data-toggle="modal" data-target="#editdata">تعديل</button>
                                    <button class="btn btn-danger my-2" onclick="deleteData(${i})" id="delete">الحذف</button>
                                </div>
                            </div>
                        </td>
                    </tr>
                `;
            }
        }
    }else if(searchMood === 'type'){
        for(i=0; i < StoreData.length; i++){
            if(StoreData[i].typeOfdevice.includes(value)){
                data += `
                    <tr>
                        <td>${StoreData[i].code}</td>
                        <td>${StoreData[i].imel}</td>
                        <td>${StoreData[i].sn}</td>
                        <td>${StoreData[i].typeOfdevice}</td>
                        <td>${StoreData[i].typeOfpay}</td>
                        <td>${StoreData[i].stateOfdevice}</td>
                        <td>${StoreData[i].paydate}</td>
                        <td>${StoreData[i].payvalue}</td>
                        <td>${StoreData[i].traderCode}</td>
                        <td>${StoreData[i].traderName}</td>
                        <td>${StoreData[i].exitdate}</td>
                        <td>${StoreData[i].backdate}</td>
                        <td>${StoreData[i].maintenanceCoast}</td>
                        <td>
                            <div class="dropdown">
                                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" style="padding: 0 !important; height: 35px; width: 55px;">
                                    <svg class="svg-inline--fa fa-gear p-1" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="gear" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"></path></svg><!-- <i class="fa fa-cog p-1"></i> Font Awesome fontawesome.com -->
                                </button>
                                <div class="dropdown-menu" style="position: absolute; transform: translate3d(2px, 35px, 0px); top: 0px; left: 0px; will-change: transform;" x-placement="bottom-start">
                                    <button class="btn btn-primary my-2" onclick="updateData(${i})" data-toggle="modal" data-target="#editdata">تعديل</button>
                                    <button class="btn btn-danger my-2" onclick="deleteData(${i})" id="delete">الحذف</button>
                                </div>
                            </div>
                        </td>
                    </tr>
                `;
            }
        }
    }else if(searchMood === 'stateOFdevice'){
        for(i=0; i < StoreData.length; i++){
            if(StoreData[i].stateOfdevice.includes(value)){
                data += `
                    <tr>
                        <td>${StoreData[i].code}</td>
                        <td>${StoreData[i].imel}</td>
                        <td>${StoreData[i].sn}</td>
                        <td>${StoreData[i].typeOfdevice}</td>
                        <td>${StoreData[i].typeOfpay}</td>
                        <td>${StoreData[i].stateOfdevice}</td>
                        <td>${StoreData[i].paydate}</td>
                        <td>${StoreData[i].payvalue}</td>
                        <td>${StoreData[i].traderCode}</td>
                        <td>${StoreData[i].traderName}</td>
                        <td>${StoreData[i].exitdate}</td>
                        <td>${StoreData[i].backdate}</td>
                        <td>${StoreData[i].maintenanceCoast}</td>
                        <td>
                            <div class="dropdown">
                                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" style="padding: 0 !important; height: 35px; width: 55px;">
                                    <svg class="svg-inline--fa fa-gear p-1" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="gear" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"></path></svg><!-- <i class="fa fa-cog p-1"></i> Font Awesome fontawesome.com -->
                                </button>
                                <div class="dropdown-menu" style="position: absolute; transform: translate3d(2px, 35px, 0px); top: 0px; left: 0px; will-change: transform;" x-placement="bottom-start">
                                    <button class="btn btn-primary my-2" onclick="updateData(${i})" data-toggle="modal" data-target="#editdata">تعديل</button>
                                    <button class="btn btn-danger my-2" onclick="deleteData(${i})" id="delete">الحذف</button>
                                </div>
                            </div>
                        </td>
                    </tr>
                `;
            }
        }
    }else if(searchMood === 'imei'){
    }else if(searchMood === 'typeOFpay'){
        for(i=0; i < StoreData.length; i++){
            if(StoreData[i].typeOfpay.includes(value)){
                data += `
                    <tr>
                        <td>${StoreData[i].code}</td>
                        <td>${StoreData[i].imel}</td>
                        <td>${StoreData[i].sn}</td>
                        <td>${StoreData[i].typeOfdevice}</td>
                        <td>${StoreData[i].typeOfpay}</td>
                        <td>${StoreData[i].stateOfdevice}</td>
                        <td>${StoreData[i].paydate}</td>
                        <td>${StoreData[i].payvalue}</td>
                        <td>${StoreData[i].traderCode}</td>
                        <td>${StoreData[i].traderName}</td>
                        <td>${StoreData[i].exitdate}</td>
                        <td>${StoreData[i].backdate}</td>
                        <td>${StoreData[i].maintenanceCoast}</td>
                        <td>
                            <div class="dropdown">
                                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" style="padding: 0 !important; height: 35px; width: 55px;">
                                    <svg class="svg-inline--fa fa-gear p-1" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="gear" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"></path></svg><!-- <i class="fa fa-cog p-1"></i> Font Awesome fontawesome.com -->
                                </button>
                                <div class="dropdown-menu" style="position: absolute; transform: translate3d(2px, 35px, 0px); top: 0px; left: 0px; will-change: transform;" x-placement="bottom-start">
                                    <button class="btn btn-primary my-2" onclick="updateData(${i})" data-toggle="modal" data-target="#editdata">تعديل</button>
                                    <button class="btn btn-danger my-2" onclick="deleteData(${i})" id="delete">الحذف</button>
                                </div>
                            </div>
                        </td>
                    </tr>
                `;
            }
        }
    }else if(searchMood === 'sn'){
        for(i=0; i < StoreData.length; i++){
            if(StoreData[i].sn.includes(value)){
                data += `
                    <tr>
                        <td>${StoreData[i].code}</td>
                        <td>${StoreData[i].imel}</td>
                        <td>${StoreData[i].sn}</td>
                        <td>${StoreData[i].typeOfdevice}</td>
                        <td>${StoreData[i].typeOfpay}</td>
                        <td>${StoreData[i].stateOfdevice}</td>
                        <td>${StoreData[i].paydate}</td>
                        <td>${StoreData[i].payvalue}</td>
                        <td>${StoreData[i].traderCode}</td>
                        <td>${StoreData[i].traderName}</td>
                        <td>${StoreData[i].exitdate}</td>
                        <td>${StoreData[i].backdate}</td>
                        <td>${StoreData[i].maintenanceCoast}</td>
                        <td>
                            <div class="dropdown">
                                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" style="padding: 0 !important; height: 35px; width: 55px;">
                                    <svg class="svg-inline--fa fa-gear p-1" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="gear" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"></path></svg><!-- <i class="fa fa-cog p-1"></i> Font Awesome fontawesome.com -->
                                </button>
                                <div class="dropdown-menu" style="position: absolute; transform: translate3d(2px, 35px, 0px); top: 0px; left: 0px; will-change: transform;" x-placement="bottom-start">
                                    <button class="btn btn-primary my-2" onclick="updateData(${i})" data-toggle="modal" data-target="#editdata">تعديل</button>
                                    <button class="btn btn-danger my-2" onclick="deleteData(${i})" id="delete">الحذف</button>
                                </div>
                            </div>
                        </td>
                    </tr>
                `;
            }
        }
    }
	document.querySelector('#body-data').innerHTML = data;
}
// savedata
function saveData(tmp) {
	if (
		(code.src != '',
        imel.value != '',
        sn.value != '',
        typeOfdevice.value != '',
        typeOfpay.value != '',
        stateOfdevice.value != '',
        paydate.value != '',
        payvalue.value != '',
        traderCode.value != '',
        traderName.value != '',
        exitdate.value != '',
        backdate.value != '',
        maintenanceCoast.value != '')
	) {
		if (mood === 'create') {
			StoreData[StoreData.length] = {
				code: code.value,
				imel: imel.value,
				sn: sn.value,
				typeOfdevice: typeOfdevice.value,
				typeOfpay: typeOfpay.value,
				stateOfdevice: stateOfdevice.value,
				paydate: paydate.value,
				payvalue: payvalue.value,
				traderCode: traderCode.value,
				traderName: traderName.value,
				exitdate: exitdate.value,
				backdate: backdate.value,
				maintenanceCoast: maintenanceCoast.value,
                
			};
		} else {
			StoreData[tmp].code = code.value;
            StoreData[tmp].imel = imel.value;
            StoreData[tmp].sn = sn.value;
            StoreData[tmp].typeOfdevice = typeOfdevice.value;
            StoreData[tmp].typeOfpay = typeOfpay.value;
            StoreData[tmp].stateOfdevice = stateOfdevice.value;
            StoreData[tmp].paydate = paydate.value;
            StoreData[tmp].payvalue = payvalue.value;
            StoreData[tmp].traderCode = traderCode.value;
            StoreData[tmp].traderName = traderName.value;
            StoreData[tmp].exitdate = exitdate.value;
            StoreData[tmp].backdate = backdate.value;
            StoreData[tmp].maintenanceCoast = maintenanceCoast.value;
            updateDevices(tmp);
		}
		clearinput();
		ReadData();
	} else {
		alert('الحقول فارغة');
	}
}
// updateDevices
function updateDevices(tmp){
    // SUNMI
    function SUNMI(tmp){
        let go_SUNMI = document.querySelector('#go_SUNMI');
        let back_SUNMI = document.querySelector('#back_SUNMI');
        let fix_SUNMI = document.querySelector('#fix_SUNMI');
        if(StoreData[tmp].typeOfdevice === 'sunmi' || localStorage.getItem('typeOfdevice') === 'sunmi'){
            if(localStorage.getItem('state') === 'ذهاب'){
                a = a - 1;
                go_SUNMI.innerHTML = a;
            }else if(localStorage.getItem('state') === 'عودة'){
                b = b - 1;
                back_SUNMI.innerHTML = b;
            }else if(localStorage.getItem('state') === 'رفض صيانة'){
                c = c - 1;
                fix_SUNMI.innerHTML = c;
            }
        }
    }
    function INGENICO(tmp){
        let go_INGENICO = document.querySelector('#go_INGENICO');
        let back_INGENICO = document.querySelector('#back_INGENICO');
        let fix_INGENICO = document.querySelector('#fix_INGENICO');
        if(StoreData[tmp].typeOfdevice === 'ingenico' || localStorage.getItem('typeOfdevice') === 'ingenico'){
            if(localStorage.getItem('state') === 'ذهاب'){
                a = a - 1;
                go_INGENICO.innerHTML = a;
            }else if(localStorage.getItem('state') === 'عودة'){
                b = b - 1;
                back_INGENICO.innerHTML = b;
            }else if(localStorage.getItem('state') === 'رفض صيانة'){
                c = c - 1;
                fix_INGENICO.innerHTML = c;
            }
        }
    }
    function PAX(tmp){
        let go_PAX = document.querySelector('#go_PAX');
        let back_PAX = document.querySelector('#back_PAX');
        let fix_PAX = document.querySelector('#fix_PAX');
        if(StoreData[tmp].typeOfdevice === 'pax' || localStorage.getItem('typeOfdevice') === 'pax'){
            if(localStorage.getItem('state') === 'ذهاب'){
                a = a - 1;
                go_PAX.innerHTML = a;
            }else if(localStorage.getItem('state') === 'عودة'){
                b = b - 1;
                back_PAX.innerHTML = b;
            }else if(localStorage.getItem('state') === 'رفض صيانة'){
                c = c - 1;
                fix_PAX.innerHTML = c;
            }
        }
    }
    function MOBIWIRE(tmp){
        let go_MOBIWIRE = document.querySelector('#go_MOBIWIRE');
        let back_MOBIWIRE = document.querySelector('#back_MOBIWIRE');
        let fix_MOBIWIRE = document.querySelector('#fix_MOBIWIRE');
        if(StoreData[tmp].typeOfdevice === 'mobiwire' || localStorage.getItem('typeOfdevice') === 'mobiwire'){
            if(localStorage.getItem('state') === 'ذهاب'){
                a = a - 1;
                go_MOBIWIRE.innerHTML = a;
            }else if(localStorage.getItem('state') === 'عودة'){
                b = b - 1;
                back_MOBIWIRE.innerHTML = b;
            }else if(localStorage.getItem('state') === 'رفض صيانة'){
                c = c - 1;
                fix_MOBIWIRE.innerHTML = c;
            }
        }
    }
    function VERIFONE(tmp){
        let go_VERIFONE = document.querySelector('#go_VERIFONE');
        let back_VERIFONE = document.querySelector('#back_VERIFONE');
        let fix_VERIFONE = document.querySelector('#fix_VERIFONE');
        if(StoreData[tmp].typeOfdevice === 'verifone' || localStorage.getItem('typeOfdevice') === 'verifone'){
            if(localStorage.getItem('state') === 'ذهاب'){
                a = a - 1;
                go_VERIFONE.innerHTML = a;
            }else if(localStorage.getItem('state') === 'عودة'){
                b = b - 1;
                back_VERIFONE.innerHTML = b;
            }else if(localStorage.getItem('state') === 'رفض صيانة'){
                c = c - 1;
                fix_VERIFONE.innerHTML = c;
            }
        }
    }
    
    SUNMI(tmp);
    INGENICO(tmp);
    PAX(tmp);
    MOBIWIRE(tmp);
    VERIFONE(tmp);
}
// updateData
function updateData(i) {
	code.value = StoreData[i].code;
    imel.value = StoreData[i].imel;
    sn.value = StoreData[i].sn;
    typeOfdevice.value = StoreData[i].typeOfdevice;
    typeOfpay.value = StoreData[i].typeOfpay;
    stateOfdevice.value = StoreData[i].stateOfdevice;
    paydate.value = StoreData[i].paydate;
    payvalue.value = StoreData[i].payvalue;
    traderCode.value = StoreData[i].traderCode;
    traderName.value = StoreData[i].traderName;
    exitdate.value = StoreData[i].exitdate;
    backdate.value = StoreData[i].backdate;
    maintenanceCoast.value = StoreData[i].maintenanceCoast;
	save.innerHTML = 'إعادة تسجيل العنصر';
	showdataTitle.innerHTML = 'تعديل العنصر' + `<span>${i + 1}</span>`;
	mood = 'update';
	tmp = i;
    localStorage.setItem('typeOfdevice', typeOfdevice.value);
    localStorage.setItem('state', stateOfdevice.value);
}
// deletedata
function deleteData(i) {
    deldevices(i);
	StoreData.splice(i,1);
	ReadData();
}

var a,b,c;
// deldevices
function deldevices(i){
    // SUNMI
    function SUNMI(i){
        let go_SUNMI = document.querySelector('#go_SUNMI');
        let back_SUNMI = document.querySelector('#back_SUNMI');
        let fix_SUNMI = document.querySelector('#fix_SUNMI');
        if(StoreData[i].typeOfdevice === 'sunmi'){
            if(StoreData[i].stateOfdevice === 'ذهاب'){
                a = a - 1;
                go_SUNMI.innerHTML = a;
            }else if(StoreData[i].stateOfdevice === 'عودة'){
                b = b - 1;
                back_SUNMI.innerHTML = b;
            }else if(StoreData[i].stateOfdevice === 'رفض صيانة'){
                c = c - 1;
                fix_SUNMI.innerHTML = c;
            }
        }
    }
    function INGENICO(i){
        let go_INGENICO = document.querySelector('#go_INGENICO');
        let back_INGENICO = document.querySelector('#back_INGENICO');
        let fix_INGENICO = document.querySelector('#fix_INGENICO');
        if(StoreData[i].typeOfdevice === 'ingenico'){
            if(StoreData[i].stateOfdevice === 'ذهاب'){
                a = a - 1;
                go_INGENICO.innerHTML = a;
            }else if(StoreData[i].stateOfdevice === 'عودة'){
                b = b - 1;
                back_INGENICO.innerHTML = b;
            }else if(StoreData[i].stateOfdevice === 'رفض صيانة'){
                c = c - 1;
                fix_INGENICO.innerHTML = c;
            }
        }
    }
    function PAX(i){
        let go_PAX = document.querySelector('#go_PAX');
        let back_PAX = document.querySelector('#back_PAX');
        let fix_PAX = document.querySelector('#fix_PAX');
        if(StoreData[i].typeOfdevice === 'pax'){
            if(StoreData[i].stateOfdevice === 'ذهاب'){
                a = a - 1;
                go_PAX.innerHTML = a;
            }else if(StoreData[i].stateOfdevice === 'عودة'){
                b = b - 1;
                back_PAX.innerHTML = b;
            }else if(StoreData[i].stateOfdevice === 'رفض صيانة'){
                c = c - 1;
                fix_PAX.innerHTML = c;
            }
        }
    }
    function MOBIWIRE(i){
        let go_MOBIWIRE = document.querySelector('#go_MOBIWIRE');
        let back_MOBIWIRE = document.querySelector('#back_MOBIWIRE');
        let fix_MOBIWIRE = document.querySelector('#fix_MOBIWIRE');
        if(StoreData[i].typeOfdevice === 'mobiwire'){
            if(StoreData[i].stateOfdevice === 'ذهاب'){
                a = a - 1;
                go_MOBIWIRE.innerHTML = a;
            }else if(StoreData[i].stateOfdevice === 'عودة'){
                b = b - 1;
                back_MOBIWIRE.innerHTML = b;
            }else if(StoreData[i].stateOfdevice === 'رفض صيانة'){
                c = c - 1;
                fix_MOBIWIRE.innerHTML = c;
            }
        }
    }
    function VERIFONE(i){
        let go_VERIFONE = document.querySelector('#go_VERIFONE');
        let back_VERIFONE = document.querySelector('#back_VERIFONE');
        let fix_VERIFONE = document.querySelector('#fix_VERIFONE');
        if(StoreData[i].typeOfdevice === 'verifone'){
            if(StoreData[i].stateOfdevice === 'ذهاب'){
                a = a - 1;
                go_VERIFONE.innerHTML = a;
            }else if(StoreData[i].stateOfdevice === 'عودة'){
                b = b - 1;
                back_VERIFONE.innerHTML = b;
            }else if(StoreData[i].stateOfdevice === 'رفض صيانة'){
                c = c - 1;
                fix_VERIFONE.innerHTML = c;
            }
        }
    }
    
    SUNMI(i);
    INGENICO(i);
    PAX(i);
    MOBIWIRE(i);
    VERIFONE(i);
}
// devices
function devices(){
    // SUNMI
    function SUNMI(){
        let go_SUNMI = document.querySelector('#go_SUNMI');
        let back_SUNMI = document.querySelector('#back_SUNMI');
        let fix_SUNMI = document.querySelector('#fix_SUNMI');
        a = 0,b = 0,c = 0,d = 0,e = 0,f = 0;
        for (let i = 0; i < StoreData.length; i++) {
            if(StoreData[i].typeOfdevice === 'sunmi'){
                if(StoreData[i].stateOfdevice === 'ذهاب'){
                    a = a + 1;
                    go_SUNMI.innerHTML = a;
                } 
                if(StoreData[i].stateOfdevice === 'عودة'){
                    b = b + 1;
                    back_SUNMI.innerHTML = b;
                } 
                if(StoreData[i].stateOfdevice === 'رفض صيانة'){
                    c = c + 1;
                    fix_SUNMI.innerHTML = c;
                }
            }
        }
    }
    function INGENICO(){
        let go_INGENICO = document.querySelector('#go_INGENICO');
        let back_INGENICO = document.querySelector('#back_INGENICO');
        let fix_INGENICO = document.querySelector('#fix_INGENICO');
        a = 0,b = 0,c = 0,d = 0,e = 0,f = 0;
        for (let i = 0; i < StoreData.length; i++) {
            if(StoreData[i].typeOfdevice === 'ingenico'){
                if(StoreData[i].stateOfdevice === 'ذهاب'){
                    a = a + 1;
                    go_INGENICO.innerHTML = a;
                }else if(StoreData[i].stateOfdevice === 'عودة'){
                    b = b + 1;
                    back_INGENICO.innerHTML = b;
                }else if(StoreData[i].stateOfdevice === 'رفض صيانة'){
                    c = c + 1;
                    fix_INGENICO.innerHTML = c;
                }
            }
        }
    }
    function PAX(){
        let go_PAX = document.querySelector('#go_PAX');
        let back_PAX = document.querySelector('#back_PAX');
        let fix_PAX = document.querySelector('#fix_PAX');
        a = 0,b = 0,c = 0,d = 0,e = 0,f = 0;
        for (let i = 0; i < StoreData.length; i++) {
            if(StoreData[i].typeOfdevice === 'pax'){
                if(StoreData[i].stateOfdevice === 'ذهاب'){
                    a = a + 1;
                    go_PAX.innerHTML = a;
                }else if(StoreData[i].stateOfdevice === 'عودة'){
                    b = b + 1;
                    back_PAX.innerHTML = b;
                }else if(StoreData[i].stateOfdevice === 'رفض صيانة'){
                    c = c + 1;
                    fix_PAX.innerHTML = c;
                }
            }
        }
    }
    function MOBIWIRE(){
        let go_MOBIWIRE = document.querySelector('#go_MOBIWIRE');
        let back_MOBIWIRE = document.querySelector('#back_MOBIWIRE');
        let fix_MOBIWIRE = document.querySelector('#fix_MOBIWIRE');
        a = 0,b = 0,c = 0,d = 0,e = 0,f = 0;
        for (let i = 0; i < StoreData.length; i++) {
            if(StoreData[i].typeOfdevice === 'mobiwire'){
                if(StoreData[i].stateOfdevice === 'ذهاب'){
                    a = a + 1;
                    go_MOBIWIRE.innerHTML = a;
                }else if(StoreData[i].stateOfdevice === 'عودة'){
                    b = b + 1;
                    back_MOBIWIRE.innerHTML = b;
                }else if(StoreData[i].stateOfdevice === 'رفض صيانة'){
                    c = c + 1;
                    fix_MOBIWIRE.innerHTML = c;
                }
            }
        }
    }
    function VERIFONE(){
        let go_VERIFONE = document.querySelector('#go_VERIFONE');
        let back_VERIFONE = document.querySelector('#back_VERIFONE');
        let fix_VERIFONE = document.querySelector('#fix_VERIFONE');
        a = 0,b = 0,c = 0,d = 0,e = 0,f = 0;
        for (let i = 0; i < StoreData.length; i++) {
            if(StoreData[i].typeOfdevice === 'verifone'){
                if(StoreData[i].stateOfdevice === 'ذهاب'){
                    a = a + 1;
                    go_VERIFONE.innerHTML = a;
                }else if(StoreData[i].stateOfdevice === 'عودة'){
                    b = b + 1;
                    back_VERIFONE.innerHTML = b;
                }else if(StoreData[i].stateOfdevice === 'رفض صيانة'){
                    c = c + 1;
                    fix_VERIFONE.innerHTML = c;
                }
            }
        }
    }
    
    SUNMI();
    INGENICO();
    PAX();
    MOBIWIRE();
    VERIFONE();
}
// clear
function clearinput() {
	code.value = '';
	imel.value = '';
	sn.value = '';
	typeOfdevice.value = '';
	typeOfpay.value = '';
	stateOfdevice.value = '';
	paydate.value = '';
	payvalue.value = '';
	traderCode.value = '';
	traderName.value = '';
	exitdate.value = '';
	backdate.value = '';
	maintenanceCoast.value = '';
	save.innerHTML = 'تسجيل';
	showdataTitle.innerHTML = 'إنشاء عنصر';
	mood = 'create';
}
// export to xslx
function ExportToXLSX(type, fn, dl) {
	var table = document.getElementById('table');
	var wb = XLSX.utils.table_to_book(table, { sheet: 'sheet1' });
	return dl
		? XLSX.write(wb, { bookType: type, bookSST: true, type: 'base64' })
		: XLSX.writeFile(wb, fn || 'store.' + (type || 'xls'));
}
// export to pdf
function ExportToPDF() {
	var table = document.getElementById('table');
	var opt = {
		margin: 1,
		filename: 'store.pdf',
		image: { type: 'jpeg', quality: 0.98 },
		html2canvas: { scale: 2 },
		jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
	};
	pdf(table, opt);
}